parameters:
- name: BuildId
  default: $(Build.BuildId)
- name: SourceVersion
  default: $(Build.SourceVersion)

steps:
  - checkout: self
    persistCredentials: true

  - task: PowerShell@2
    displayName: "Create and publish tag"
    inputs:
      targetType: 'filePath'
      filePath: '$(Pipeline.Workspace)/auto_tag/create-tag.ps1'
      arguments: '-buildId ${{parameters.BuildId}}" -commitId "${{parameters.SourceVersion}}"'

